{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/blog/setup-gitlab-runners-in-kubernetes-k3s-part-2/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://zanechua.com"}},"posts":{"html":"<p>Continuing from <a href=\"/blog/setup-gitlab-runners-in-kubernetes-k3s-part-1\">part 1</a> of the setup.</p>\n<h1 id=\"Solve\" style=\"position:relative;\">Solve<a href=\"#Solve\" aria-label=\"Solve permalink\" class=\"remark-header-anchor after\"><svg id=\"header-anchor-icon\" aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<h2 id=\"GitLab-Runner-Setup\" style=\"position:relative;\">GitLab Runner Setup<a href=\"#GitLab-Runner-Setup\" aria-label=\"GitLab Runner Setup permalink\" class=\"remark-header-anchor after\"><svg id=\"header-anchor-icon\" aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"Install-Helm\" style=\"position:relative;\">Install Helm<a href=\"#Install-Helm\" aria-label=\"Install Helm permalink\" class=\"remark-header-anchor after\"><svg id=\"header-anchor-icon\" aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">main</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"36053925093959060000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash`, `36053925093959060000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">curl</span> https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 <span class=\"token operator\">|</span> <span class=\"token function\">bash</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3 id=\"Prepare-the-cluster-to-connect\" style=\"position:relative;\">Prepare the cluster to connect<a href=\"#Prepare-the-cluster-to-connect\" aria-label=\"Prepare the cluster to connect permalink\" class=\"remark-header-anchor after\"><svg id=\"header-anchor-icon\" aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<blockquote>\n<p>The following cluster certificate connection type is deprecated and disabled by default in GitLab 15.0.\nConnecting the cluster to GitLab is not necessary for connecting the runners, so you can skip this section\nif you do not need to monitor the instance or using it for e.g. review apps.\nI'm leaving this section here but hidden as it's not really required.</p>\n</blockquote>\n<details>\n<summary>\n  <span class=\"summary-title\">Show/Hide</span>\n  <div class=\"summary-chevron-up\">\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-down\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>\n  </div>\n</summary>\n<div class=\"summary-content\">\n<p>Applying the following manifest:</p>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">gitlab-admin-service-account.yaml</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"6967321047643837000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: gitlab\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: gitlab-admin\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n  - kind: ServiceAccount\n    name: gitlab\n    namespace: kube-system`, `6967321047643837000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ServiceAccount\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> gitlab\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>system\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> rbac.authorization.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterRoleBinding\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> gitlab<span class=\"token punctuation\">-</span>admin\n<span class=\"token key atrule\">roleRef</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">apiGroup</span><span class=\"token punctuation\">:</span> rbac.authorization.k8s.io\n  <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterRole\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>admin\n<span class=\"token key atrule\">subjects</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ServiceAccount\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> gitlab\n    <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>system</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">main</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"25954712178621750000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`kubectl apply -f gitlab-admin-service-account.yaml`, `25954712178621750000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">kubectl apply <span class=\"token parameter variable\">-f</span> gitlab-admin-service-account.yaml</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Get the cluster certificate</p>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">main</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"82482975747477640000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`kubectl config view --raw \\\n-o=jsonpath='{.clusters[0].cluster.certificate-authority-data}' \\\n| base64 --decode`, `82482975747477640000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">kubectl config view <span class=\"token parameter variable\">--raw</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">-o</span><span class=\"token operator\">=</span>jsonpath<span class=\"token operator\">=</span><span class=\"token string\">'{.clusters[0].cluster.certificate-authority-data}'</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token operator\">|</span> base64 <span class=\"token parameter variable\">--decode</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Get the service token</p>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">main</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"28471027022743687000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`kubectl -n kube-system describe secret \\$(kubectl -n kube-system get secret | grep gitlab | awk '{print \\$1}')`, `28471027022743687000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">kubectl <span class=\"token parameter variable\">-n</span> kube-system describe secret <span class=\"token variable\"><span class=\"token variable\">$(</span>kubectl <span class=\"token parameter variable\">-n</span> kube-system get secret <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> gitlab <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'{print $1}'</span><span class=\"token variable\">)</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Once you have the above, use the <code class=\"language-text\">Connect cluster with certificate</code> option in GitLab and choose to <code class=\"language-text\">Connect existing cluster</code>. You'll be given a form to fill up the information that we've gathered above. The <code class=\"language-text\">API URL</code> would be the FQDN that you've assigned to your cluster.</p>\n<blockquote>\n<p>Remember to add an allow rule to your firewall (NAT Port Forwarding) for the cluster. I'm assuming that you know how to do this, if there is any clarification needed around this, leave a comment.</p>\n</blockquote>\n</div>\n<div class=\"summary-chevron-down\">\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-up\"><polyline points=\"18 15 12 9 6 15\"></polyline></svg>\n</div>\n</details>\n<h3 id=\"Preparing-the-Runner-Manifest\" style=\"position:relative;\">Preparing the Runner Manifest<a href=\"#Preparing-the-Runner-Manifest\" aria-label=\"Preparing the Runner Manifest permalink\" class=\"remark-header-anchor after\"><svg id=\"header-anchor-icon\" aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Go to <code class=\"language-text\">Settings -> CI/CD -> Runners</code> and note down the runner registration token</p>\n<p>Prepare the manifest for the runner setup and fill in the <code class=\"language-text\">runnerRegistrationToken</code>.</p>\n<p>The <code class=\"language-text\">pre_clone_script</code> was obtained from <a href=\"https://gitlab.com/gitlab-org/gitlab-foss/-/issues/47283#note_164716469\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">here</a>.</p>\n<details>\n<summary>\n  <span class=\"summary-title\">Manifest file</span>\n  <div class=\"summary-chevron-up\">\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-down\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>\n  </div>\n</summary>\n<div class=\"summary-content\">\n<div class=\"gatsby-code-title gatsby-remark-code-title\">gitlab-runner.yaml</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"95421915480477250000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`## GitLab Runner Image\n##\n## By default it's using gitlab/gitlab-runner:alpine-v{VERSION}\n## where {VERSION} is taken from Chart.yaml from appVersion field\n##\n## ref: https://hub.docker.com/r/gitlab/gitlab-runner/tags/\n##\n## Note: If you change the image to the ubuntu release\n##       don't forget to change the securityContext;\n##       these images run on different user IDs.\n##\n# image: gitlab/gitlab-runner:alpine-v11.6.0\n\n## Specify a imagePullPolicy for the main runner deployment\n## 'Always' if imageTag is 'latest', else set to 'IfNotPresent'\n##\n## Note: it does not apply to job containers launched by this executor.\n## Use \\`pull_policy\\` in [runners.kubernetes] to change it.\n##\n## ref: https://kubernetes.io/docs/concepts/containers/assets/#pre-pulled-images\n##\nimagePullPolicy: IfNotPresent\n\n## Specifying ImagePullSecrets on a Pod\n## Kubernetes supports specifying container image registry keys on a Pod.\n## ref: https://kubernetes.io/docs/concepts/containers/assets/#specifying-imagepullsecrets-on-a-pod\n##\n# imagePullSecrets:\n#   - name: &quot;image-pull-secret&quot;\n\n## How many runner pods to launch.\n# replicas: 1\n\n## How many old ReplicaSets for this Deployment you want to retain\n# revisionHistoryLimit: 10\n\n## The GitLab Server URL (with protocol) that want to register the runner against\n## ref: https://docs.gitlab.com/runner/commands/README.html#gitlab-runner-register\n##\ngitlabUrl: https://gitlab.com/\n\n## The Registration Token for adding new Runners to the GitLab Server. This must\n## be retrieved from your GitLab Instance.\n## ref: https://docs.gitlab.com/ce/ci/runners/README.html\n##\nrunnerRegistrationToken: &quot;&quot;\n\n## The Runner Token for adding new Runners to the GitLab Server. This must\n## be retrieved from your GitLab Instance. It is token of already registered runner.\n## ref: (we don't yet have docs for that, but we want to use existing token)\n##\n# runnerToken: &quot;&quot;\n#\n## Unregister all runners before termination\n##\n## Updating the runner's chart version or configuration will cause the runner container\n## to be terminated and created again. This may cause your Gitlab instance to reference\n## non-existant runners. Un-registering the runner before termination mitigates this issue.\n## ref: https://docs.gitlab.com/runner/commands/README.html#gitlab-runner-unregister\n##\n# unregisterRunners: true\n\n## When stopping the runner, give it time to wait for its jobs to terminate.\n##\n## Updating the runner's chart version or configuration will cause the runner container\n## to be terminated with a graceful stop request. terminationGracePeriodSeconds\n## instructs Kubernetes to wait long enough for the runner pod to terminate gracefully.\n## ref: https://docs.gitlab.com/runner/commands/#signals\nterminationGracePeriodSeconds: 3600\n\n## Set the certsSecretName in order to pass custom certficates for GitLab Runner to use\n## Provide resource name for a Kubernetes Secret Object in the same namespace,\n## this is used to populate the /home/gitlab-runner/.gitlab-runner/certs/ directory\n## ref: https://docs.gitlab.com/runner/configuration/tls-self-signed.html#supported-options-for-self-signed-certificates\n##\n# certsSecretName:\n\n## Configure the maximum number of concurrent jobs\n## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section\n##\nconcurrent: 10\n\n## Defines in seconds how often to check GitLab for a new builds\n## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section\n##\ncheckInterval: 30\n\n## Configure GitLab Runner's logging level. Available values are: debug, info, warn, error, fatal, panic\n## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section\n##\n# logLevel:\n\n## Configure GitLab Runner's logging format. Available values are: runner, text, json\n## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section\n##\n# logFormat:\n\n## Configure GitLab Runner's Sentry DSN.\n## ref https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section\n##\n# sentryDsn:\n\n## A custom bash script that will be executed prior to the invocation\n## gitlab-runner process\n#\n#preEntrypointScript: |\n#  echo &quot;hello&quot;\n\n## For RBAC support:\nrbac:\n  create: true\n\n  ## Define specific rbac permissions.\n  ## DEPRECATED: see .Values.rbac.rules\n  # resources: [&quot;pods&quot;, &quot;pods/exec&quot;, &quot;secrets&quot;]\n  # verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;patch&quot;, &quot;delete&quot;]\n\n  ## Define list of rules to be added to the rbac role permissions.\n  ## Each rule supports the keys:\n  ## - apiGroups: default &quot;&quot; (indicates the core API group) if missing or empty.\n  ## - resources: default &quot;*&quot; if missing or empty.\n  ## - verbs: default &quot;*&quot; if missing or empty.\n  rules: []\n  # - resources: [&quot;pods&quot;, &quot;secrets&quot;]\n  #   verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;patch&quot;, &quot;delete&quot;]\n  # - apiGroups: [&quot;&quot;]\n  #   resources: [&quot;pods/exec&quot;]\n  #   verbs: [&quot;create&quot;, &quot;patch&quot;, &quot;delete&quot;]\n\n  ## Run the gitlab-bastion container with the ability to deploy/manage containers of jobs\n  ## cluster-wide or only within namespace\n  clusterWideAccess: false\n\n  ## Use the following Kubernetes Service Account name if RBAC is disabled in this Helm chart (see rbac.create)\n  ##\n  # serviceAccountName: default\n\n  ## Specify annotations for Service Accounts, useful for annotations such as eks.amazonaws.com/role-arn\n  ##\n  ## ref: https://docs.aws.amazon.com/eks/latest/userguide/specify-service-account-role.html\n  ##\n  # serviceAccountAnnotations: {}\n\n  ## Use podSecurity Policy\n  ## ref: https://kubernetes.io/docs/concepts/policy/pod-security-policy/\n  podSecurityPolicy:\n    enabled: false\n    resourceNames:\n    - gitlab-runner\n\n  ## Specify one or more imagePullSecrets used for pulling the runner image\n  ##\n  ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#add-imagepullsecrets-to-a-service-account\n  ##\n  # imagePullSecrets: []\n\n## Configure integrated Prometheus metrics exporter\n## ref: https://docs.gitlab.com/runner/monitoring/#configuration-of-the-metrics-http-server\nmetrics:\n  enabled: true\n\n## Configuration for the Pods that the runner launches for each new job\n##\nrunners:\n  # runner configuration, where the multi line strings is evaluated as\n  # template so you can specify helm values inside of it.\n  #\n  # tpl: https://helm.sh/docs/howto/charts_tips_and_tricks/#using-the-tpl-function\n  # runner configuration: https://docs.gitlab.com/runner/configuration/advanced-configuration.html\n  config: |\n    [[runners]]\n      pre_clone_script = 'cat /etc/resolv.conf | sed -r &quot;s/^(search.*|options.*)/#\\1/&quot; > /tmp/resolv && cat /tmp/resolv > /etc/resolv.conf'\n      [runners.kubernetes]\n        namespace = &quot;{{.Release.Namespace}}&quot;\n        image = &quot;alpine:latest&quot;\n        ## privileged = true\n\n  ## Which executor should be used\n  ##\n  # executor: kubernetes\n\n  ## Default container image to use for builds when none is specified\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # image: ubuntu:16.04\n\n  ## Specify one or more imagePullSecrets\n  ##\n  ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # imagePullSecrets: []\n\n  ## Specify the image pull policy: never, if-not-present, always. The cluster default will be used if not set.\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # imagePullPolicy: &quot;&quot;\n\n  ## Defines number of concurrent requests for new job from GitLab\n  ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-section\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # requestConcurrency: 1\n\n  ## Specify whether the runner should be locked to a specific project: true, false. Defaults to true.\n  ##\n  # locked: true\n\n  ## Specify the tags associated with the runner. Comma-separated list of tags.\n  ##\n  ## ref: https://docs.gitlab.com/ce/ci/runners/#use-tags-to-limit-the-number-of-jobs-using-the-runner\n  ##\n  tags: &quot;k3s,container&quot;\n\n  ## Specify the name for the runner.\n  ##\n  name: &quot;k3snetes&quot;\n\n  ## Specify if jobs without tags should be run.\n  ## If not specified, Runner will default to true if no tags were specified. In other case it will\n  ## default to false.\n  ##\n  ## ref: https://docs.gitlab.com/ce/ci/runners/#runner-is-allowed-to-run-untagged-jobs\n  ##\n  # runUntagged: true\n\n  ## Specify whether the runner should only run protected branches.\n  ## Defaults to False.\n  ##\n  ## ref: https://docs.gitlab.com/ee/ci/runners/#prevent-runners-from-revealing-sensitive-information\n  ##\n  # protected: true\n\n  ## Run all containers with the privileged flag enabled\n  ## This will allow the docker:dind image to run if you need to run Docker\n  ## commands. Please read the docs before turning this on:\n  ## ref: https://docs.gitlab.com/runner/executors/kubernetes.html#using-dockerdind\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # privileged: false\n\n  ## The name of the secret containing runner-token and runner-registration-token\n  # secret: gitlab-runner\n\n  ## Namespace to run Kubernetes jobs in (defaults to the same namespace of this release)\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # namespace:\n\n  ## The amount of time, in seconds, that needs to pass before the runner will\n  ## timeout attempting to connect to the container it has just created.\n  ## ref: https://docs.gitlab.com/runner/executors/kubernetes.html\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # pollTimeout: 180\n\n  ## Set maximum build log size in kilobytes, by default set to 4096 (4MB)\n  ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-section\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # outputLimit: 4096\n\n  ## Distributed runners caching\n  ## ref: https://docs.gitlab.com/runner/configuration/autoscale.html#distributed-runners-caching\n  ##\n  ## If you want to use s3 based distributing caching:\n  ## First of all you need to uncomment General settings and S3 settings sections.\n  ##\n  ## Create a secret 's3access' containing 'accesskey' & 'secretkey'\n  ## ref: https://aws.amazon.com/blogs/security/wheres-my-secret-access-key/\n  ##\n  ## \\$ kubectl create secret generic s3access \\\n  ##   --from-literal=accesskey=&quot;YourAccessKey&quot; \\\n  ##   --from-literal=secretkey=&quot;YourSecretKey&quot;\n  ## ref: https://kubernetes.io/docs/concepts/configuration/secret/\n  ##\n  ## If you want to use gcs based distributing caching:\n  ## First of all you need to uncomment General settings and GCS settings sections.\n  ##\n  ## Access using credentials file:\n  ## Create a secret 'google-application-credentials' containing your application credentials file.\n  ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runnerscachegcs-section\n  ## You could configure\n  ## \\$ kubectl create secret generic google-application-credentials \\\n  ##   --from-file=gcs-application-credentials-file=./path-to-your-google-application-credentials-file.json\n  ## ref: https://kubernetes.io/docs/concepts/configuration/secret/\n  ##\n  ## Access using access-id and private-key:\n  ## Create a secret 'gcsaccess' containing 'gcs-access-id' & 'gcs-private-key'.\n  ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runnerscachegcs-section\n  ## You could configure\n  ## \\$ kubectl create secret generic gcsaccess \\\n  ##   --from-literal=gcs-access-id=&quot;YourAccessID&quot; \\\n  ##   --from-literal=gcs-private-key=&quot;YourPrivateKey&quot;\n  ## ref: https://kubernetes.io/docs/concepts/configuration/secret/\n  ##\n  ## If you want to use Azure-based distributed caching:\n  ## First, uncomment General settings.\n  ##\n  ## Create a secret 'azureaccess' containing 'azure-account-name' & 'azure-account-key'\n  ## ref: https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction\n  ##\n  ## \\$ kubectl create secret generic azureaccess \\\n  ##   --from-literal=azure-account-name=&quot;YourAccountName&quot; \\\n  ##   --from-literal=azure-account-key=&quot;YourAccountKey&quot;\n  ## ref: https://kubernetes.io/docs/concepts/configuration/secret/\n\n  cache:\n    ## General settings\n    ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration and https://docs.gitlab.com/runner/install/kubernetes.html#using-cache-with-configuration-template\n    # cacheType: s3\n    # cachePath: &quot;gitlab_runner&quot;\n    # cacheShared: true\n\n    ## S3 settings\n    ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration and https://docs.gitlab.com/runner/install/kubernetes.html#using-cache-with-configuration-template\n    # s3ServerAddress: s3.amazonaws.com\n    # s3BucketName:\n    # s3BucketLocation:\n    # s3CacheInsecure: false\n\n    ## GCS settings\n    ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration and https://docs.gitlab.com/runner/install/kubernetes.html#using-cache-with-configuration-template\n    # gcsBucketName:\n\n    ## S3 the name of the secret.\n    # secretName: s3access\n    ## Use this line for access using gcs-access-id and gcs-private-key\n    # secretName: gcsaccess\n    ## Use this line for access using google-application-credentials file\n    # secretName: google-application-credentials\n    ## Use this line for access using Azure with azure-account-name and azure-account-key\n    # secretName: azureaccess\n\n\n  ## Build Container specific configuration\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  builds: {}\n    # cpuLimit: 200m\n    # cpuLimitOverwriteMaxAllowed: 400m\n    # memoryLimit: 256Mi\n    # memoryLimitOverwriteMaxAllowed: 512Mi\n    # cpuRequests: 100m\n    # cpuRequestsOverwriteMaxAllowed: 200m\n    # memoryRequests: 128Mi\n    # memoryRequestsOverwriteMaxAllowed: 256Mi\n\n  ## Service Container specific configuration\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  services: {}\n    # cpuLimit: 200m\n    # memoryLimit: 256Mi\n    # cpuRequests: 100m\n    # memoryRequests: 128Mi\n\n  ## Helper Container specific configuration\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  helpers: {}\n    # cpuLimit: 200m\n    # memoryLimit: 256Mi\n    # cpuRequests: 100m\n    # memoryRequests: 128Mi\n    # image: &quot;gitlab/gitlab-runner-helper:x86_64-\\${CI_RUNNER_REVISION}&quot;\n\n  ## Helper container security context configuration\n  ## Refer to https://docs.gitlab.com/runner/executors/kubernetes.html#using-security-context\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # pod_security_context:\n  #   run_as_non_root: true\n  #   run_as_user: 100\n  #   run_as_group: 100\n  #   fs_group: 65533\n  #   supplemental_groups: [101, 102]\n\n  ## Service Account to be used for runners\n  ##\n  # serviceAccountName:\n\n  ## If Gitlab is not reachable through \\$CI_SERVER_URL\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # cloneUrl:\n\n  ## Specify node labels for CI job pods assignment\n  ## ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # nodeSelector: {}\n\n  ## Specify node tolerations for CI job pods assignment\n  ## ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # nodeTolerations: {}\n\n  ## Specify pod labels for CI job pods\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # podLabels: {}\n\n  ## Specify annotations for job pods, useful for annotations such as iam.amazonaws.com/role\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # podAnnotations: {}\n\n  ## Configure environment variables that will be injected to the pods that are created while\n  ## the build is running. These variables are passed as parameters, i.e. \\`--env &quot;NAME=VALUE&quot;\\`,\n  ## to \\`gitlab-runner register\\` command.\n  ##\n  ## Note that \\`envVars\\` (see below) are only present in the runner pod, not the pods that are\n  ## created for each build.\n  ##\n  ## ref: https://docs.gitlab.com/runner/commands/#gitlab-runner-register\n  ##\n  ## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration\n  # env:\n  #   NAME: VALUE\n\n\n## Specify the name of the scheduler which used to schedule runner pods.\n## Kubernetes supports multiple scheduler configurations.\n## ref: https://kubernetes.io/docs/reference/scheduling\n# schedulerName: &quot;my-custom-scheduler&quot;\n\n## Configure securitycontext\n## ref: http://kubernetes.io/docs/user-guide/security-context/\n##\npodSecurityContext:\n  runAsUser: 100\n  # runAsGroup: 65533\n  fsGroup: 65533\n  # supplementalGroups: [65533]\n\n  ## Note: values for the ubuntu image:\n  # runAsUser: 999\n  # fsGroup: 999\n\n## Configure resource requests and limits\n## ref: http://kubernetes.io/docs/user-guide/compute-resources/\n##\nresources: {}\n  # limits:\n  #   memory: 256Mi\n  #   cpu: 200m\n  # requests:\n  #   memory: 128Mi\n  #   cpu: 100m\n\n## Affinity for pod assignment\n## Ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity\n##\naffinity: {}\n\n## Node labels for pod assignment\n## Ref: https://kubernetes.io/docs/user-guide/node-selection/\n##\nnodeSelector: {}\n  # Example: The gitlab runner manager should not run on spot instances so you can assign\n  # them to the regular worker nodes only.\n  # node-role.kubernetes.io/worker: &quot;true&quot;\n\n## List of node taints to tolerate (requires Kubernetes >= 1.6)\n## Ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/\n##\ntolerations: []\n  # Example: Regular worker nodes may have a taint, thus you need to tolerate the taint\n  # when you assign the gitlab runner manager with nodeSelector or affinity to the nodes.\n  # - key: &quot;node-role.kubernetes.io/worker&quot;\n  #   operator: &quot;Exists&quot;\n\n## Configure environment variables that will be present when the registration command runs\n## This provides further control over the registration process and the config.toml file\n## ref: \\`gitlab-runner register --help\\`\n## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html\n##\n# envVars:\n#   - name: RUNNER_EXECUTOR\n#     value: kubernetes\n\n## list of hosts and IPs that will be injected into the pod's hosts file\nhostAliases: []\n  # Example:\n  # - ip: &quot;127.0.0.1&quot;\n  #   hostnames:\n  #   - &quot;foo.local&quot;\n  #   - &quot;bar.local&quot;\n  # - ip: &quot;10.1.2.3&quot;\n  #   hostnames:\n  #   - &quot;foo.remote&quot;\n  #   - &quot;bar.remote&quot;\n\n## Annotations to be added to manager pod\n##\npodAnnotations: {}\n  # Example:\n  # iam.amazonaws.com/role: <my_role_arn>\n\n## Labels to be added to manager pod\n##\npodLabels: {}\n  # Example:\n  # owner.team: <my_cool_team>\n\n## HPA support for custom metrics:\n## This section enables runners to autoscale based on defined custom metrics.\n## In order to use this functionality, Need to enable a custom metrics API server by\n## implementing &quot;custom.metrics.k8s.io&quot; using supported third party adapter\n## Example: https://github.com/directxman12/k8s-prometheus-adapter\n##\n#hpa: {}\n  # minReplicas: 1\n  # maxReplicas: 10\n  # metrics:\n  # - type: Pods\n  #   pods:\n  #     metricName: gitlab_runner_jobs\n  #     targetAverageValue: 400m\n\n## Secrets to be additionally mounted to the containers.\n## All secrets are mounted through init-runner-secrets volume\n## and placed as readonly at /init-secrets in the init container\n## and finally copied to an in-memory volume runner-secrets that is\n## mounted at /secrets.\nsecrets: []\n  # Example:\n  # - name: my-secret\n  # - name: myOtherSecret\n  #   items:\n  #     - key: key_one\n  #       path: path_one\n\n## Additional config files to mount in the containers in \\`/configmaps\\`.\n##\n## Please note that a number of keys are reserved by the runner.\n## See https://gitlab.com/gitlab-org/charts/gitlab-runner/-/blob/main/templates/configmap.yaml\n## for a current list.\nconfigMaps: {}`, `95421915480477250000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token comment\">## GitLab Runner Image</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\">## By default it's using gitlab/gitlab-runner:alpine-v{VERSION}</span>\n<span class=\"token comment\">## where {VERSION} is taken from Chart.yaml from appVersion field</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\">## ref: https://hub.docker.com/r/gitlab/gitlab-runner/tags/</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\">## Note: If you change the image to the ubuntu release</span>\n<span class=\"token comment\">##       don't forget to change the securityContext;</span>\n<span class=\"token comment\">##       these images run on different user IDs.</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\"># image: gitlab/gitlab-runner:alpine-v11.6.0</span>\n\n<span class=\"token comment\">## Specify a imagePullPolicy for the main runner deployment</span>\n<span class=\"token comment\">## 'Always' if imageTag is 'latest', else set to 'IfNotPresent'</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\">## Note: it does not apply to job containers launched by this executor.</span>\n<span class=\"token comment\">## Use `pull_policy` in [runners.kubernetes] to change it.</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\">## ref: https://kubernetes.io/docs/concepts/containers/assets/#pre-pulled-images</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">imagePullPolicy</span><span class=\"token punctuation\">:</span> IfNotPresent\n\n<span class=\"token comment\">## Specifying ImagePullSecrets on a Pod</span>\n<span class=\"token comment\">## Kubernetes supports specifying container image registry keys on a Pod.</span>\n<span class=\"token comment\">## ref: https://kubernetes.io/docs/concepts/containers/assets/#specifying-imagepullsecrets-on-a-pod</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\"># imagePullSecrets:</span>\n<span class=\"token comment\">#   - name: \"image-pull-secret\"</span>\n\n<span class=\"token comment\">## How many runner pods to launch.</span>\n<span class=\"token comment\"># replicas: 1</span>\n\n<span class=\"token comment\">## How many old ReplicaSets for this Deployment you want to retain</span>\n<span class=\"token comment\"># revisionHistoryLimit: 10</span>\n\n<span class=\"token comment\">## The GitLab Server URL (with protocol) that want to register the runner against</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/commands/README.html#gitlab-runner-register</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">gitlabUrl</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//gitlab.com/\n\n<span class=\"token comment\">## The Registration Token for adding new Runners to the GitLab Server. This must</span>\n<span class=\"token comment\">## be retrieved from your GitLab Instance.</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/ce/ci/runners/README.html</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">runnerRegistrationToken</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n\n<span class=\"token comment\">## The Runner Token for adding new Runners to the GitLab Server. This must</span>\n<span class=\"token comment\">## be retrieved from your GitLab Instance. It is token of already registered runner.</span>\n<span class=\"token comment\">## ref: (we don't yet have docs for that, but we want to use existing token)</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\"># runnerToken: \"\"</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\">## Unregister all runners before termination</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\">## Updating the runner's chart version or configuration will cause the runner container</span>\n<span class=\"token comment\">## to be terminated and created again. This may cause your Gitlab instance to reference</span>\n<span class=\"token comment\">## non-existant runners. Un-registering the runner before termination mitigates this issue.</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/commands/README.html#gitlab-runner-unregister</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\"># unregisterRunners: true</span>\n\n<span class=\"token comment\">## When stopping the runner, give it time to wait for its jobs to terminate.</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\">## Updating the runner's chart version or configuration will cause the runner container</span>\n<span class=\"token comment\">## to be terminated with a graceful stop request. terminationGracePeriodSeconds</span>\n<span class=\"token comment\">## instructs Kubernetes to wait long enough for the runner pod to terminate gracefully.</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/commands/#signals</span>\n<span class=\"token key atrule\">terminationGracePeriodSeconds</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n\n<span class=\"token comment\">## Set the certsSecretName in order to pass custom certficates for GitLab Runner to use</span>\n<span class=\"token comment\">## Provide resource name for a Kubernetes Secret Object in the same namespace,</span>\n<span class=\"token comment\">## this is used to populate the /home/gitlab-runner/.gitlab-runner/certs/ directory</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/tls-self-signed.html#supported-options-for-self-signed-certificates</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\"># certsSecretName:</span>\n\n<span class=\"token comment\">## Configure the maximum number of concurrent jobs</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">concurrent</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span>\n\n<span class=\"token comment\">## Defines in seconds how often to check GitLab for a new builds</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">checkInterval</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30</span>\n\n<span class=\"token comment\">## Configure GitLab Runner's logging level. Available values are: debug, info, warn, error, fatal, panic</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\"># logLevel:</span>\n\n<span class=\"token comment\">## Configure GitLab Runner's logging format. Available values are: runner, text, json</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\"># logFormat:</span>\n\n<span class=\"token comment\">## Configure GitLab Runner's Sentry DSN.</span>\n<span class=\"token comment\">## ref https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\"># sentryDsn:</span>\n\n<span class=\"token comment\">## A custom bash script that will be executed prior to the invocation</span>\n<span class=\"token comment\">## gitlab-runner process</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\">#preEntrypointScript: |</span>\n<span class=\"token comment\">#  echo \"hello\"</span>\n\n<span class=\"token comment\">## For RBAC support:</span>\n<span class=\"token key atrule\">rbac</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">create</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n  <span class=\"token comment\">## Define specific rbac permissions.</span>\n  <span class=\"token comment\">## DEPRECATED: see .Values.rbac.rules</span>\n  <span class=\"token comment\"># resources: [\"pods\", \"pods/exec\", \"secrets\"]</span>\n  <span class=\"token comment\"># verbs: [\"get\", \"list\", \"watch\", \"create\", \"patch\", \"delete\"]</span>\n\n  <span class=\"token comment\">## Define list of rules to be added to the rbac role permissions.</span>\n  <span class=\"token comment\">## Each rule supports the keys:</span>\n  <span class=\"token comment\">## - apiGroups: default \"\" (indicates the core API group) if missing or empty.</span>\n  <span class=\"token comment\">## - resources: default \"*\" if missing or empty.</span>\n  <span class=\"token comment\">## - verbs: default \"*\" if missing or empty.</span>\n  <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token comment\"># - resources: [\"pods\", \"secrets\"]</span>\n  <span class=\"token comment\">#   verbs: [\"get\", \"list\", \"watch\", \"create\", \"patch\", \"delete\"]</span>\n  <span class=\"token comment\"># - apiGroups: [\"\"]</span>\n  <span class=\"token comment\">#   resources: [\"pods/exec\"]</span>\n  <span class=\"token comment\">#   verbs: [\"create\", \"patch\", \"delete\"]</span>\n\n  <span class=\"token comment\">## Run the gitlab-bastion container with the ability to deploy/manage containers of jobs</span>\n  <span class=\"token comment\">## cluster-wide or only within namespace</span>\n  <span class=\"token key atrule\">clusterWideAccess</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n\n  <span class=\"token comment\">## Use the following Kubernetes Service Account name if RBAC is disabled in this Helm chart (see rbac.create)</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\"># serviceAccountName: default</span>\n\n  <span class=\"token comment\">## Specify annotations for Service Accounts, useful for annotations such as eks.amazonaws.com/role-arn</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## ref: https://docs.aws.amazon.com/eks/latest/userguide/specify-service-account-role.html</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\"># serviceAccountAnnotations: {}</span>\n\n  <span class=\"token comment\">## Use podSecurity Policy</span>\n  <span class=\"token comment\">## ref: https://kubernetes.io/docs/concepts/policy/pod-security-policy/</span>\n  <span class=\"token key atrule\">podSecurityPolicy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">resourceNames</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> gitlab<span class=\"token punctuation\">-</span>runner\n\n  <span class=\"token comment\">## Specify one or more imagePullSecrets used for pulling the runner image</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## ref: https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#add-imagepullsecrets-to-a-service-account</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\"># imagePullSecrets: []</span>\n\n<span class=\"token comment\">## Configure integrated Prometheus metrics exporter</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/monitoring/#configuration-of-the-metrics-http-server</span>\n<span class=\"token key atrule\">metrics</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n<span class=\"token comment\">## Configuration for the Pods that the runner launches for each new job</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">runners</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># runner configuration, where the multi line strings is evaluated as</span>\n  <span class=\"token comment\"># template so you can specify helm values inside of it.</span>\n  <span class=\"token comment\">#</span>\n  <span class=\"token comment\"># tpl: https://helm.sh/docs/howto/charts_tips_and_tricks/#using-the-tpl-function</span>\n  <span class=\"token comment\"># runner configuration: https://docs.gitlab.com/runner/configuration/advanced-configuration.html</span>\n  <span class=\"token key atrule\">config</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n    [[runners]]\n      pre_clone_script = 'cat /etc/resolv.conf | sed -r \"s/^(search.*|options.*)/#\\1/\" > /tmp/resolv &amp;&amp; cat /tmp/resolv > /etc/resolv.conf'\n      [runners.kubernetes]\n        namespace = \"{{.Release.Namespace}}\"\n        image = \"alpine:latest\"\n        ## privileged = true</span>\n\n  <span class=\"token comment\">## Which executor should be used</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\"># executor: kubernetes</span>\n\n  <span class=\"token comment\">## Default container image to use for builds when none is specified</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># image: ubuntu:16.04</span>\n\n  <span class=\"token comment\">## Specify one or more imagePullSecrets</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## ref: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># imagePullSecrets: []</span>\n\n  <span class=\"token comment\">## Specify the image pull policy: never, if-not-present, always. The cluster default will be used if not set.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># imagePullPolicy: \"\"</span>\n\n  <span class=\"token comment\">## Defines number of concurrent requests for new job from GitLab</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-section</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># requestConcurrency: 1</span>\n\n  <span class=\"token comment\">## Specify whether the runner should be locked to a specific project: true, false. Defaults to true.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\"># locked: true</span>\n\n  <span class=\"token comment\">## Specify the tags associated with the runner. Comma-separated list of tags.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/ce/ci/runners/#use-tags-to-limit-the-number-of-jobs-using-the-runner</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token key atrule\">tags</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"k3s,container\"</span>\n\n  <span class=\"token comment\">## Specify the name for the runner.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"k3snetes\"</span>\n\n  <span class=\"token comment\">## Specify if jobs without tags should be run.</span>\n  <span class=\"token comment\">## If not specified, Runner will default to true if no tags were specified. In other case it will</span>\n  <span class=\"token comment\">## default to false.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/ce/ci/runners/#runner-is-allowed-to-run-untagged-jobs</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\"># runUntagged: true</span>\n\n  <span class=\"token comment\">## Specify whether the runner should only run protected branches.</span>\n  <span class=\"token comment\">## Defaults to False.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/ee/ci/runners/#prevent-runners-from-revealing-sensitive-information</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\"># protected: true</span>\n\n  <span class=\"token comment\">## Run all containers with the privileged flag enabled</span>\n  <span class=\"token comment\">## This will allow the docker:dind image to run if you need to run Docker</span>\n  <span class=\"token comment\">## commands. Please read the docs before turning this on:</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/runner/executors/kubernetes.html#using-dockerdind</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># privileged: false</span>\n\n  <span class=\"token comment\">## The name of the secret containing runner-token and runner-registration-token</span>\n  <span class=\"token comment\"># secret: gitlab-runner</span>\n\n  <span class=\"token comment\">## Namespace to run Kubernetes jobs in (defaults to the same namespace of this release)</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># namespace:</span>\n\n  <span class=\"token comment\">## The amount of time, in seconds, that needs to pass before the runner will</span>\n  <span class=\"token comment\">## timeout attempting to connect to the container it has just created.</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/runner/executors/kubernetes.html</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># pollTimeout: 180</span>\n\n  <span class=\"token comment\">## Set maximum build log size in kilobytes, by default set to 4096 (4MB)</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-section</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># outputLimit: 4096</span>\n\n  <span class=\"token comment\">## Distributed runners caching</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/autoscale.html#distributed-runners-caching</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## If you want to use s3 based distributing caching:</span>\n  <span class=\"token comment\">## First of all you need to uncomment General settings and S3 settings sections.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## Create a secret 's3access' containing 'accesskey' &amp; 'secretkey'</span>\n  <span class=\"token comment\">## ref: https://aws.amazon.com/blogs/security/wheres-my-secret-access-key/</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## $ kubectl create secret generic s3access \\</span>\n  <span class=\"token comment\">##   --from-literal=accesskey=\"YourAccessKey\" \\</span>\n  <span class=\"token comment\">##   --from-literal=secretkey=\"YourSecretKey\"</span>\n  <span class=\"token comment\">## ref: https://kubernetes.io/docs/concepts/configuration/secret/</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## If you want to use gcs based distributing caching:</span>\n  <span class=\"token comment\">## First of all you need to uncomment General settings and GCS settings sections.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## Access using credentials file:</span>\n  <span class=\"token comment\">## Create a secret 'google-application-credentials' containing your application credentials file.</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runnerscachegcs-section</span>\n  <span class=\"token comment\">## You could configure</span>\n  <span class=\"token comment\">## $ kubectl create secret generic google-application-credentials \\</span>\n  <span class=\"token comment\">##   --from-file=gcs-application-credentials-file=./path-to-your-google-application-credentials-file.json</span>\n  <span class=\"token comment\">## ref: https://kubernetes.io/docs/concepts/configuration/secret/</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## Access using access-id and private-key:</span>\n  <span class=\"token comment\">## Create a secret 'gcsaccess' containing 'gcs-access-id' &amp; 'gcs-private-key'.</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runnerscachegcs-section</span>\n  <span class=\"token comment\">## You could configure</span>\n  <span class=\"token comment\">## $ kubectl create secret generic gcsaccess \\</span>\n  <span class=\"token comment\">##   --from-literal=gcs-access-id=\"YourAccessID\" \\</span>\n  <span class=\"token comment\">##   --from-literal=gcs-private-key=\"YourPrivateKey\"</span>\n  <span class=\"token comment\">## ref: https://kubernetes.io/docs/concepts/configuration/secret/</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## If you want to use Azure-based distributed caching:</span>\n  <span class=\"token comment\">## First, uncomment General settings.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## Create a secret 'azureaccess' containing 'azure-account-name' &amp; 'azure-account-key'</span>\n  <span class=\"token comment\">## ref: https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## $ kubectl create secret generic azureaccess \\</span>\n  <span class=\"token comment\">##   --from-literal=azure-account-name=\"YourAccountName\" \\</span>\n  <span class=\"token comment\">##   --from-literal=azure-account-key=\"YourAccountKey\"</span>\n  <span class=\"token comment\">## ref: https://kubernetes.io/docs/concepts/configuration/secret/</span>\n\n  <span class=\"token key atrule\">cache</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\">## General settings</span>\n    <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration and https://docs.gitlab.com/runner/install/kubernetes.html#using-cache-with-configuration-template</span>\n    <span class=\"token comment\"># cacheType: s3</span>\n    <span class=\"token comment\"># cachePath: \"gitlab_runner\"</span>\n    <span class=\"token comment\"># cacheShared: true</span>\n\n    <span class=\"token comment\">## S3 settings</span>\n    <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration and https://docs.gitlab.com/runner/install/kubernetes.html#using-cache-with-configuration-template</span>\n    <span class=\"token comment\"># s3ServerAddress: s3.amazonaws.com</span>\n    <span class=\"token comment\"># s3BucketName:</span>\n    <span class=\"token comment\"># s3BucketLocation:</span>\n    <span class=\"token comment\"># s3CacheInsecure: false</span>\n\n    <span class=\"token comment\">## GCS settings</span>\n    <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration and https://docs.gitlab.com/runner/install/kubernetes.html#using-cache-with-configuration-template</span>\n    <span class=\"token comment\"># gcsBucketName:</span>\n\n    <span class=\"token comment\">## S3 the name of the secret.</span>\n    <span class=\"token comment\"># secretName: s3access</span>\n    <span class=\"token comment\">## Use this line for access using gcs-access-id and gcs-private-key</span>\n    <span class=\"token comment\"># secretName: gcsaccess</span>\n    <span class=\"token comment\">## Use this line for access using google-application-credentials file</span>\n    <span class=\"token comment\"># secretName: google-application-credentials</span>\n    <span class=\"token comment\">## Use this line for access using Azure with azure-account-name and azure-account-key</span>\n    <span class=\"token comment\"># secretName: azureaccess</span>\n\n\n  <span class=\"token comment\">## Build Container specific configuration</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token key atrule\">builds</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token comment\"># cpuLimit: 200m</span>\n    <span class=\"token comment\"># cpuLimitOverwriteMaxAllowed: 400m</span>\n    <span class=\"token comment\"># memoryLimit: 256Mi</span>\n    <span class=\"token comment\"># memoryLimitOverwriteMaxAllowed: 512Mi</span>\n    <span class=\"token comment\"># cpuRequests: 100m</span>\n    <span class=\"token comment\"># cpuRequestsOverwriteMaxAllowed: 200m</span>\n    <span class=\"token comment\"># memoryRequests: 128Mi</span>\n    <span class=\"token comment\"># memoryRequestsOverwriteMaxAllowed: 256Mi</span>\n\n  <span class=\"token comment\">## Service Container specific configuration</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token comment\"># cpuLimit: 200m</span>\n    <span class=\"token comment\"># memoryLimit: 256Mi</span>\n    <span class=\"token comment\"># cpuRequests: 100m</span>\n    <span class=\"token comment\"># memoryRequests: 128Mi</span>\n\n  <span class=\"token comment\">## Helper Container specific configuration</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token key atrule\">helpers</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token comment\"># cpuLimit: 200m</span>\n    <span class=\"token comment\"># memoryLimit: 256Mi</span>\n    <span class=\"token comment\"># cpuRequests: 100m</span>\n    <span class=\"token comment\"># memoryRequests: 128Mi</span>\n    <span class=\"token comment\"># image: \"gitlab/gitlab-runner-helper:x86_64-${CI_RUNNER_REVISION}\"</span>\n\n  <span class=\"token comment\">## Helper container security context configuration</span>\n  <span class=\"token comment\">## Refer to https://docs.gitlab.com/runner/executors/kubernetes.html#using-security-context</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># pod_security_context:</span>\n  <span class=\"token comment\">#   run_as_non_root: true</span>\n  <span class=\"token comment\">#   run_as_user: 100</span>\n  <span class=\"token comment\">#   run_as_group: 100</span>\n  <span class=\"token comment\">#   fs_group: 65533</span>\n  <span class=\"token comment\">#   supplemental_groups: [101, 102]</span>\n\n  <span class=\"token comment\">## Service Account to be used for runners</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\"># serviceAccountName:</span>\n\n  <span class=\"token comment\">## If Gitlab is not reachable through $CI_SERVER_URL</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># cloneUrl:</span>\n\n  <span class=\"token comment\">## Specify node labels for CI job pods assignment</span>\n  <span class=\"token comment\">## ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># nodeSelector: {}</span>\n\n  <span class=\"token comment\">## Specify node tolerations for CI job pods assignment</span>\n  <span class=\"token comment\">## ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># nodeTolerations: {}</span>\n\n  <span class=\"token comment\">## Specify pod labels for CI job pods</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># podLabels: {}</span>\n\n  <span class=\"token comment\">## Specify annotations for job pods, useful for annotations such as iam.amazonaws.com/role</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># podAnnotations: {}</span>\n\n  <span class=\"token comment\">## Configure environment variables that will be injected to the pods that are created while</span>\n  <span class=\"token comment\">## the build is running. These variables are passed as parameters, i.e. `--env \"NAME=VALUE\"`,</span>\n  <span class=\"token comment\">## to `gitlab-runner register` command.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## Note that `envVars` (see below) are only present in the runner pod, not the pods that are</span>\n  <span class=\"token comment\">## created for each build.</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## ref: https://docs.gitlab.com/runner/commands/#gitlab-runner-register</span>\n  <span class=\"token comment\">##</span>\n  <span class=\"token comment\">## DEPRECATED: See https://docs.gitlab.com/runner/install/kubernetes.html#additional-configuration</span>\n  <span class=\"token comment\"># env:</span>\n  <span class=\"token comment\">#   NAME: VALUE</span>\n\n\n<span class=\"token comment\">## Specify the name of the scheduler which used to schedule runner pods.</span>\n<span class=\"token comment\">## Kubernetes supports multiple scheduler configurations.</span>\n<span class=\"token comment\">## ref: https://kubernetes.io/docs/reference/scheduling</span>\n<span class=\"token comment\"># schedulerName: \"my-custom-scheduler\"</span>\n\n<span class=\"token comment\">## Configure securitycontext</span>\n<span class=\"token comment\">## ref: http://kubernetes.io/docs/user-guide/security-context/</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">podSecurityContext</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">runAsUser</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span>\n  <span class=\"token comment\"># runAsGroup: 65533</span>\n  <span class=\"token key atrule\">fsGroup</span><span class=\"token punctuation\">:</span> <span class=\"token number\">65533</span>\n  <span class=\"token comment\"># supplementalGroups: [65533]</span>\n\n  <span class=\"token comment\">## Note: values for the ubuntu image:</span>\n  <span class=\"token comment\"># runAsUser: 999</span>\n  <span class=\"token comment\"># fsGroup: 999</span>\n\n<span class=\"token comment\">## Configure resource requests and limits</span>\n<span class=\"token comment\">## ref: http://kubernetes.io/docs/user-guide/compute-resources/</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token comment\"># limits:</span>\n  <span class=\"token comment\">#   memory: 256Mi</span>\n  <span class=\"token comment\">#   cpu: 200m</span>\n  <span class=\"token comment\"># requests:</span>\n  <span class=\"token comment\">#   memory: 128Mi</span>\n  <span class=\"token comment\">#   cpu: 100m</span>\n\n<span class=\"token comment\">## Affinity for pod assignment</span>\n<span class=\"token comment\">## Ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">affinity</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">## Node labels for pod assignment</span>\n<span class=\"token comment\">## Ref: https://kubernetes.io/docs/user-guide/node-selection/</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">nodeSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token comment\"># Example: The gitlab runner manager should not run on spot instances so you can assign</span>\n  <span class=\"token comment\"># them to the regular worker nodes only.</span>\n  <span class=\"token comment\"># node-role.kubernetes.io/worker: \"true\"</span>\n\n<span class=\"token comment\">## List of node taints to tolerate (requires Kubernetes >= 1.6)</span>\n<span class=\"token comment\">## Ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">tolerations</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token comment\"># Example: Regular worker nodes may have a taint, thus you need to tolerate the taint</span>\n  <span class=\"token comment\"># when you assign the gitlab runner manager with nodeSelector or affinity to the nodes.</span>\n  <span class=\"token comment\"># - key: \"node-role.kubernetes.io/worker\"</span>\n  <span class=\"token comment\">#   operator: \"Exists\"</span>\n\n<span class=\"token comment\">## Configure environment variables that will be present when the registration command runs</span>\n<span class=\"token comment\">## This provides further control over the registration process and the config.toml file</span>\n<span class=\"token comment\">## ref: `gitlab-runner register --help`</span>\n<span class=\"token comment\">## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\"># envVars:</span>\n<span class=\"token comment\">#   - name: RUNNER_EXECUTOR</span>\n<span class=\"token comment\">#     value: kubernetes</span>\n\n<span class=\"token comment\">## list of hosts and IPs that will be injected into the pod's hosts file</span>\n<span class=\"token key atrule\">hostAliases</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token comment\"># Example:</span>\n  <span class=\"token comment\"># - ip: \"127.0.0.1\"</span>\n  <span class=\"token comment\">#   hostnames:</span>\n  <span class=\"token comment\">#   - \"foo.local\"</span>\n  <span class=\"token comment\">#   - \"bar.local\"</span>\n  <span class=\"token comment\"># - ip: \"10.1.2.3\"</span>\n  <span class=\"token comment\">#   hostnames:</span>\n  <span class=\"token comment\">#   - \"foo.remote\"</span>\n  <span class=\"token comment\">#   - \"bar.remote\"</span>\n\n<span class=\"token comment\">## Annotations to be added to manager pod</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">podAnnotations</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token comment\"># Example:</span>\n  <span class=\"token comment\"># iam.amazonaws.com/role: &lt;my_role_arn></span>\n\n<span class=\"token comment\">## Labels to be added to manager pod</span>\n<span class=\"token comment\">##</span>\n<span class=\"token key atrule\">podLabels</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token comment\"># Example:</span>\n  <span class=\"token comment\"># owner.team: &lt;my_cool_team></span>\n\n<span class=\"token comment\">## HPA support for custom metrics:</span>\n<span class=\"token comment\">## This section enables runners to autoscale based on defined custom metrics.</span>\n<span class=\"token comment\">## In order to use this functionality, Need to enable a custom metrics API server by</span>\n<span class=\"token comment\">## implementing \"custom.metrics.k8s.io\" using supported third party adapter</span>\n<span class=\"token comment\">## Example: https://github.com/directxman12/k8s-prometheus-adapter</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\">#hpa: {}</span>\n  <span class=\"token comment\"># minReplicas: 1</span>\n  <span class=\"token comment\"># maxReplicas: 10</span>\n  <span class=\"token comment\"># metrics:</span>\n  <span class=\"token comment\"># - type: Pods</span>\n  <span class=\"token comment\">#   pods:</span>\n  <span class=\"token comment\">#     metricName: gitlab_runner_jobs</span>\n  <span class=\"token comment\">#     targetAverageValue: 400m</span>\n\n<span class=\"token comment\">## Secrets to be additionally mounted to the containers.</span>\n<span class=\"token comment\">## All secrets are mounted through init-runner-secrets volume</span>\n<span class=\"token comment\">## and placed as readonly at /init-secrets in the init container</span>\n<span class=\"token comment\">## and finally copied to an in-memory volume runner-secrets that is</span>\n<span class=\"token comment\">## mounted at /secrets.</span>\n<span class=\"token key atrule\">secrets</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token comment\"># Example:</span>\n  <span class=\"token comment\"># - name: my-secret</span>\n  <span class=\"token comment\"># - name: myOtherSecret</span>\n  <span class=\"token comment\">#   items:</span>\n  <span class=\"token comment\">#     - key: key_one</span>\n  <span class=\"token comment\">#       path: path_one</span>\n\n<span class=\"token comment\">## Additional config files to mount in the containers in `/configmaps`.</span>\n<span class=\"token comment\">##</span>\n<span class=\"token comment\">## Please note that a number of keys are reserved by the runner.</span>\n<span class=\"token comment\">## See https://gitlab.com/gitlab-org/charts/gitlab-runner/-/blob/main/templates/configmap.yaml</span>\n<span class=\"token comment\">## for a current list.</span>\n<span class=\"token key atrule\">configMaps</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</div>\n<div class=\"summary-chevron-down\">\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-up\"><polyline points=\"18 15 12 9 6 15\"></polyline></svg>\n</div>\n</details>\n<h3 id=\"Installing-the-Runner\" style=\"position:relative;\">Installing the Runner<a href=\"#Installing-the-Runner\" aria-label=\"Installing the Runner permalink\" class=\"remark-header-anchor after\"><svg id=\"header-anchor-icon\" aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Run the following commands to install the gitlab-runner helm chart.</p>\n<ol>\n<li>Create <code class=\"language-text\">gitlab-runner</code> namespace</li>\n<li>Add the gitlab helm chart repo</li>\n<li>Install the <code class=\"language-text\">gitlab-runner</code> chart to <code class=\"language-text\">gitlab-runner</code> namespace</li>\n</ol>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">main</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"85229151255573600000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`kubectl create ns gitlab-runner\nhelm repo add gitlab https://charts.gitlab.io\nhelm install --namespace gitlab-runner gitlab-runner -f gitlab-runner.yaml gitlab/gitlab-runner`, `85229151255573600000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">kubectl create ns gitlab-runner\nhelm repo <span class=\"token function\">add</span> gitlab https://charts.gitlab.io\nhelm <span class=\"token function\">install</span> <span class=\"token parameter variable\">--namespace</span> gitlab-runner gitlab-runner <span class=\"token parameter variable\">-f</span> gitlab-runner.yaml gitlab/gitlab-runner</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>If you run the <code class=\"language-text\">helm install</code> command and get the error of <code class=\"language-text\">Error: INSTALLATION FAILED: Kubernetes cluster unreachable: the server has asked for the client to provide credentials</code>\nYou can try exporting the credentials again <code class=\"language-text\">kubectl config view --raw > ~/.kube/config</code> to see if that helps</p>\n</blockquote>\n<p>That should install smoothly and auto-provision runners as and when they are needed.</p>\n<p>If you want to uninstall the chart you can run:</p>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">main</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"96191452078416700000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`helm uninstall --namespace gitlab-runner gitlab-runner`, `96191452078416700000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">helm uninstall <span class=\"token parameter variable\">--namespace</span> gitlab-runner gitlab-runner</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"Change-Log\" style=\"position:relative;\">Change Log<a href=\"#Change-Log\" aria-label=\"Change Log permalink\" class=\"remark-header-anchor after\"><svg id=\"header-anchor-icon\" aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li><code class=\"language-text\">2023-08-04</code> - Added a note about potentially encountering an error running the helm command with regards to <code class=\"language-text\">credentials</code></li>\n<li><code class=\"language-text\">2022-09-08</code> - Updated runner manifest to use the new <code class=\"language-text\">podSecurityContext</code> instead of <code class=\"language-text\">securityContext</code> and hide cluster certificate connection</li>\n</ul>","excerpt":"Continuing from part 1 of the setup. Solve GitLab Runner Setup Install Helm Prepare the cluster to connect The following cluster certificate connection type is deprecated and disabled by default in GitLab 15.0.\nConnecting the cluster to GitLab is not","timeToRead":13,"frontmatter":{"date":"22 October, 2021","updatedAt":["2023-08-04"],"slug":"setup-gitlab-runners-in-kubernetes-k3s-part-2","title":"Setting up GitLab Runners in Kubernetes (K3S) - Part 2","tags":["homelab","infrastructure","kubernetes","dev ops","gitlab","ci cd","esxi"],"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAC4jAAAuIwF4pT92AAAA4UlEQVR42mMIdW7HisKc2/0de/zsu/0cevydesKc2zDVMGDVGeTQFujQ0RoWVxxcXOab1+ydFODUjakfi+YQp/aM4HYvh6mri/z/bzX+P5NhVZyTh/2kCJdWAprDXdu9LVt3LZ51ZkbWmsKk/4dj/q5Xa0it8rXtCndpI6i5zduma0pxzf9Z3F+zuP6fbby9vSHUuQOr7xgwwqktxLkzwqn+UZ3Y/ziG/8tc57Z3eVm0Rri2ExVgQOf5OfZ2RcQd9dfeleiW4t8W5AgKfGJDG6g0wLHbx6nf174n2LEdV3QCALuivtcV6O+0AAAAAElFTkSuQmCC"},"backgroundColor":"transparent","images":{"fallback":{"src":"/static/6144034945e35de431500a4fa7d29cba/6fc77/setup-gitlab-runners-in-kubernetes-k3s.png","srcSet":"/static/6144034945e35de431500a4fa7d29cba/85ced/setup-gitlab-runners-in-kubernetes-k3s.png 800w,\n/static/6144034945e35de431500a4fa7d29cba/7c498/setup-gitlab-runners-in-kubernetes-k3s.png 1080w,\n/static/6144034945e35de431500a4fa7d29cba/6fc77/setup-gitlab-runners-in-kubernetes-k3s.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/6144034945e35de431500a4fa7d29cba/28281/setup-gitlab-runners-in-kubernetes-k3s.webp 800w,\n/static/6144034945e35de431500a4fa7d29cba/0b5d5/setup-gitlab-runners-in-kubernetes-k3s.webp 1080w,\n/static/6144034945e35de431500a4fa7d29cba/a020d/setup-gitlab-runners-in-kubernetes-k3s.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":500}}}}},"comments":{"edges":[]}},"pageContext":{"slug":"setup-gitlab-runners-in-kubernetes-k3s-part-2"}},"staticQueryHashes":["3649515864","983108779"],"slicesMap":{}}