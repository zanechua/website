{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/blog/proper-line-number-height-prismjs-gatsby/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://zanechua.com"}},"posts":{"html":"<p>Configuring the <code class=\"language-text\">gatsby-remark-prismjs</code> plugin for <code class=\"language-text\">prism.js</code> in Gatsby works pretty well except for the fact that if your line of code overflows into the next line, the default configuration that's provided does not cater for that. I went digging through the source code, through the typical implementation of <code class=\"language-text\">prism.js</code> and found out that there is a snippet of code that is typically ran on the client side to recalculate the height of each line and adjust it accordingly.</p>\n<p>There's no solution that is documented in <code class=\"language-text\">gatsby-remark-prismjs</code> except for the adaptations that's been made and to refer back to client side implementation of <code class=\"language-text\">prism.js</code></p>\n<p>Here's my solution to get proper line height for each line even if it overflows.</p>\n<h1 id=\"Solve\" style=\"position:relative;\">Solve<a href=\"#Solve\" aria-label=\"Solve permalink\" class=\"remark-header-anchor after\"><svg id=\"header-anchor-icon\" aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">terminal</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"81031900093453220000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`yarn add @react-hook/window-size`, `81031900093453220000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> @react-hook/window-size</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Place the <code class=\"language-text\">prism-multiline-numbers.js</code> file in your code libraries where you are able to import the function.</p>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">prism-multiline-numbers.js</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"61232891385493635000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`// Adapted from https://github.com/PrismJS/prism/blob/master/plugins/line-numbers/prism-line-numbers.js#L82-L172\nconst NEW_LINE_EXP = /\\n(?!\\$)/g;\n\nfunction getStyles(element) {\n  if (!element) {\n    return null;\n  }\n\n  return window.getComputedStyle ? getComputedStyle(element) : element.currentStyle || null;\n}\n\nfunction resizeElements(elementToResize) {\n  const elements = elementToResize.filter(e => {\n    const codeStyles = getStyles(e);\n    const whiteSpace = codeStyles['white-space'];\n    return whiteSpace === 'pre-wrap' || whiteSpace === 'pre-line';\n  });\n\n  if (elements.length === 0) {\n    return;\n  }\n\n  const infos = elements\n    .map(element => {\n      const codeElement = element.querySelector('code');\n      const lineNumbersWrapper = element.querySelector('.line-numbers-rows');\n      if (!codeElement || !lineNumbersWrapper) {\n        return undefined;\n      }\n\n      /** @type {HTMLElement} */\n      let lineNumberSizer = element.querySelector('.line-numbers-sizer');\n      const codeLines = codeElement.textContent.split(NEW_LINE_EXP);\n\n      if (!lineNumberSizer) {\n        lineNumberSizer = document.createElement('span');\n        lineNumberSizer.className = 'line-numbers-sizer';\n\n        codeElement.appendChild(lineNumberSizer);\n      }\n\n      lineNumberSizer.innerHTML = '0';\n      lineNumberSizer.style.display = 'block';\n\n      const oneLinerHeight = lineNumberSizer.getBoundingClientRect().height;\n      lineNumberSizer.innerHTML = '';\n\n      return {\n        element,\n        lines: codeLines,\n        lineHeights: [],\n        oneLinerHeight,\n        sizer: lineNumberSizer\n      };\n    })\n    .filter(Boolean);\n\n  for (let a = 0, l = infos.length; a < l; a += 1) {\n    const info = infos[a];\n    const lineNumberSizer = info.sizer;\n    const { lines } = info;\n    const { lineHeights } = info;\n    const { oneLinerHeight } = info;\n    const wrapper = info.element.querySelector('.line-numbers-rows');\n\n    lineHeights[lines.length - 1] = undefined;\n\n    for (let i = 0, ll = lines.length; i < ll; i += 1) {\n      const line = lines[i];\n      if (line && line.length > 1) {\n        const e = lineNumberSizer.appendChild(document.createElement('span'));\n        e.style.display = 'block';\n        e.textContent = line;\n        const { height } = e.getBoundingClientRect();\n        wrapper.children[i].style.height = \\`\\${height}px\\`;\n      } else {\n        lineHeights[i] = oneLinerHeight;\n      }\n    }\n\n    lineNumberSizer.style.display = 'none';\n    lineNumberSizer.innerHTML = '';\n  }\n}\n\nexport { resizeElements };`, `61232891385493635000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">// Adapted from https://github.com/PrismJS/prism/blob/master/plugins/line-numbers/prism-line-numbers.js#L82-L172</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">NEW_LINE_EXP</span> <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\n(?!$)</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getStyles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>element<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span>getComputedStyle <span class=\"token operator\">?</span> <span class=\"token function\">getComputedStyle</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> element<span class=\"token punctuation\">.</span>currentStyle <span class=\"token operator\">||</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">resizeElements</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">elementToResize</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> elements <span class=\"token operator\">=</span> elementToResize<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> codeStyles <span class=\"token operator\">=</span> <span class=\"token function\">getStyles</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> whiteSpace <span class=\"token operator\">=</span> codeStyles<span class=\"token punctuation\">[</span><span class=\"token string\">'white-space'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> whiteSpace <span class=\"token operator\">===</span> <span class=\"token string\">'pre-wrap'</span> <span class=\"token operator\">||</span> whiteSpace <span class=\"token operator\">===</span> <span class=\"token string\">'pre-line'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>elements<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> infos <span class=\"token operator\">=</span> elements\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> codeElement <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> lineNumbersWrapper <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.line-numbers-rows'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>codeElement <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>lineNumbersWrapper<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">/** @type {HTMLElement} */</span>\n      <span class=\"token keyword\">let</span> lineNumberSizer <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.line-numbers-sizer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> codeLines <span class=\"token operator\">=</span> codeElement<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NEW_LINE_EXP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>lineNumberSizer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        lineNumberSizer <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'span'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        lineNumberSizer<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">'line-numbers-sizer'</span><span class=\"token punctuation\">;</span>\n\n        codeElement<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>lineNumberSizer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      lineNumberSizer<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">;</span>\n      lineNumberSizer<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">const</span> oneLinerHeight <span class=\"token operator\">=</span> lineNumberSizer<span class=\"token punctuation\">.</span><span class=\"token function\">getBoundingClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">;</span>\n      lineNumberSizer<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        element<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">lines</span><span class=\"token operator\">:</span> codeLines<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">lineHeights</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        oneLinerHeight<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">sizer</span><span class=\"token operator\">:</span> lineNumberSizer\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>Boolean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> a <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> l <span class=\"token operator\">=</span> infos<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> a <span class=\"token operator\">&lt;</span> l<span class=\"token punctuation\">;</span> a <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> info <span class=\"token operator\">=</span> infos<span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> lineNumberSizer <span class=\"token operator\">=</span> info<span class=\"token punctuation\">.</span>sizer<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> lines <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> info<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> lineHeights <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> info<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> oneLinerHeight <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> info<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> wrapper <span class=\"token operator\">=</span> info<span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.line-numbers-rows'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    lineHeights<span class=\"token punctuation\">[</span>lines<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> ll <span class=\"token operator\">=</span> lines<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> ll<span class=\"token punctuation\">;</span> i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> line <span class=\"token operator\">=</span> lines<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>line <span class=\"token operator\">&amp;&amp;</span> line<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> e <span class=\"token operator\">=</span> lineNumberSizer<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'span'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        e<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">;</span>\n        e<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> line<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> height <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getBoundingClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        wrapper<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>height<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        lineHeights<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> oneLinerHeight<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    lineNumberSizer<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">;</span>\n    lineNumberSizer<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> resizeElements <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>In your <code class=\"language-text\">Template</code> code, we'll trigger the function on post load and when the browser window is being resized</p>\n<div class=\"gatsby-code-title gatsby-remark-code-title\">Template.jsx</div>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"56000242984190755000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`const Template = ({}) => {\n  const [width, height] = useWindowSize();\n\n  useEffect(() => {\n    resizeElements(Array.prototype.slice.call(document.querySelectorAll('pre.line-numbers')));\n  }, [width, height]);\n\n  useEffect(() => {\n    // create an Observer instance\n    const resizeObserver = new ResizeObserver(() => {\n      resizeElements(Array.prototype.slice.call(document.querySelectorAll('pre.line-numbers')));\n    });\n\n    resizeObserver.disconnect();\n    const contentElement = document.getElementById('post-content');\n    // start observing a DOM node\n    resizeObserver.observe(contentElement);\n  }, []);\n\n  return (<></>);\n};`, `56000242984190755000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                Copy<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Template</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useWindowSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">resizeElements</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pre.line-numbers'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// create an Observer instance</span>\n    <span class=\"token keyword\">const</span> resizeObserver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ResizeObserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">resizeElements</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pre.line-numbers'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    resizeObserver<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> contentElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'post-content'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// start observing a DOM node</span>\n    resizeObserver<span class=\"token punctuation\">.</span><span class=\"token function\">observe</span><span class=\"token punctuation\">(</span>contentElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>If you're unsure how all these come together, you can take a look at the repository for this blog at <a href=\"https://github.com/zanechua/website\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/zanechua/website</a>.</p>","headings":[{"id":"Solve","value":"Solve","depth":1}],"excerpt":"Configuring the  plugin for  in Gatsby works pretty well except for the fact that if your line of code overflows into the next line, the default configuration that's provided does not cater for that. I went digging through the source code, throughâ€¦","timeToRead":2,"frontmatter":{"date":"31 March, 2023","updatedAt":null,"slug":"proper-line-number-height-prismjs-gatsby","title":"Proper Line Number Height in PrismJS with Gatsby","tags":["gatsby","node","react","javascript"],"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAC4jAAAuIwF4pT92AAAA3UlEQVR42mNYIPsaC5J5PVvw7RyBN7P5XwMRkItVGQO6kNzr+dKvl6i9vtRz+/CMe2cXfLgw491iVZAgUIqg5lcLpd/OVn/U3Fo/eW5d+/SWiqa2uWqPgYKEbZ4v+2qxzLspCvcCvCKrssITYiNsHaJmKNxbJPNugewrQjbLvgKqmyp/JyquoLogLi0iJCA4ZzrxmkE2K96NjIgpy/JPzYvzCombpnCXSM2vF8q8ma3wtMhySoFFd5bTjDybWXPkni6UJcLPUP2yb5ZIf14s/XmJ5MelUp8WyL7BGlUA8d4CUV4Bc2AAAAAASUVORK5CYII="},"backgroundColor":"transparent","images":{"fallback":{"src":"/static/ee0e918eb8b1af838626fc2ebb0053f6/6fc77/proper-line-number-height-prismjs-gatsby.png","srcSet":"/static/ee0e918eb8b1af838626fc2ebb0053f6/85ced/proper-line-number-height-prismjs-gatsby.png 800w,\n/static/ee0e918eb8b1af838626fc2ebb0053f6/7c498/proper-line-number-height-prismjs-gatsby.png 1080w,\n/static/ee0e918eb8b1af838626fc2ebb0053f6/6fc77/proper-line-number-height-prismjs-gatsby.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/ee0e918eb8b1af838626fc2ebb0053f6/28281/proper-line-number-height-prismjs-gatsby.webp 800w,\n/static/ee0e918eb8b1af838626fc2ebb0053f6/0b5d5/proper-line-number-height-prismjs-gatsby.webp 1080w,\n/static/ee0e918eb8b1af838626fc2ebb0053f6/a020d/proper-line-number-height-prismjs-gatsby.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":500}}}}},"comments":{"edges":[]}},"pageContext":{"slug":"proper-line-number-height-prismjs-gatsby"}},"staticQueryHashes":["3649515864","983108779"],"slicesMap":{}}